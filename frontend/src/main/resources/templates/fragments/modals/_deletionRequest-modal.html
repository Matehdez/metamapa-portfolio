<!-- Fragment: Modal de Solicitud de Eliminación -->
<th:block th:fragment="deletionRequestModal(eventId)" xmlns:th="http://www.thymeleaf.org">

    <!-- Modal: Solicitud de eliminación (CSS-only con :target) -->
    <div th:id="'report-hecho-' + ${eventId}" class="modal-overlay target-modal">
        <!-- Click en el fondo cierra -->
        <a href="#close" class="overlay-dismiss" aria-label="Cerrar"></a>

        <div class="auth-modal report-modal" role="dialog" aria-modal="true" th:aria-labelledby="'reportTitle-' + ${eventId}">
            <a href="#close" class="modal-close" aria-label="Cerrar">×</a>

            <h2 th:id="'reportTitle-' + ${eventId}">Solicitud de eliminación</h2>
            <p class="muted">
                Explicá por qué este contenido debería eliminarse.
                <strong>Mínimo 500 caracteres.</strong> No incluyas datos personales.
            </p>

            <form class="report-form" th:action="@{/api/deletion-request}" method="post" novalidate>
                <input type="hidden" name="eventId" th:value="${eventId}"/>

                <label class="field">
                    <span class="sr-only">Justificación</span>
                    <textarea th:id="'justificacion-' + ${eventId}"
                              name="justificacion"
                              placeholder="Justificación (mín. 500 caracteres)"
                              minlength="500"
                              required
                              rows="8"></textarea>
                    <p class="help info">Escribe una justificación clara y verificable. Evitá datos sensibles.</p>
                    <p class="help error-msg">La justificación debe tener al menos 500 caracteres.</p>
                </label>

                <div class="upload-actions">
                    <a href="#close" class="btn ghost">Cancelar</a>
                    <!-- Deshabilitado visualmente hasta que textarea sea válido (CSS-only) -->
                    <button type="submit"
                            class="btn primary submit-report"
                            th:formaction="'#reportSuccess-' + ${eventId}"
                            formmethod="get"
                            disabled>
                        Enviar solicitud
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de confirmación -->
    <div th:id="'reportSuccess-' + ${eventId}" class="modal-overlay target-modal">
        <a href="#close" class="overlay-dismiss" aria-label="Cerrar"></a>

        <div class="auth-modal success-modal" role="dialog" aria-modal="true" th:aria-labelledby="'successTitle-' + ${eventId}">
            <a href="#close" class="modal-close" aria-label="Cerrar">×</a>

            <h2 th:id="'successTitle-' + ${eventId}">Solicitud en revisión</h2>
            <p class="muted">
                ¡Gracias por colaborar con la comunidad! Revisaremos tu solicitud y
                actuaremos de acuerdo con las normas de convivencia para mantener MetaMapa
                útil, seguro y respetuoso para todas las personas.
            </p>

            <a href="#close" class="btn primary" style="margin-top:.5rem;">Entendido</a>
        </div>
    </div>

</th:block>
